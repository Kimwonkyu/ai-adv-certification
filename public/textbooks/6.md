# π“ [ν•™μµ λ…ΈνΈ] κµμ¬ 6. LLM νμΈνλ‹ (Foundation to Ultimate Deep Dive)

μ΄ κµμ¬λ” λ€κ·λ¨ λ¨λΈμ λ„λ©”μΈ νΉν™” μ§€λ¥μ„ κµ¬μ¶•ν•λ” νμΈνλ‹ λ΅λ“λ§µλ¶€ν„° ν¨μ¨μ μΈ λ§¤κ°λ³€μ ν•™μµ(PEFT) μλ¦¬ λ¨λΈ, ν•λ“μ›¨μ–΄ μµμ ν™” μ–‘μν™” μ΄λ΅ κΉμ§€ 720κ° λ¬Έν•­μ λ¨λ“  λ‚μ΄λ„λ¥Ό μ»¤λ²„ν•©λ‹λ‹¤.

---

## 1. νμΈνλ‹μ μ •μμ™€ λ‹¨κ³„λ³„ λ΅λ“λ§µ (Foundation)
νμΈνλ‹μ€ μ΄λ―Έ ν•™μµλ **Base Model**μ κ°€μ¤‘μΉλ¥Ό νΉμ • λ©μ (λ„λ©”μΈ μ§€μ‹, λ§ν¬ λ“±)μ— λ§κ² λ―Έμ„Έν•κ² μ΅°μ •ν•λ” κ³Όμ •μ…λ‹λ‹¤.

### π›£ ν•™μµ νμ΄ν”„λΌμΈ (The Tuning Stack)
1.  **SFT (Supervised Fine-tuning)**: "μ§λ¬Έ-λ‹µλ³€" μμ„ ν†µν• μ§€μ‹ μ΄ν–‰ λ¥λ ¥ ν•™μµ (Instruction Tuning).
2.  **Alignment (μ •λ ¬)**: λ¨λΈμ΄ μΈκ°„μ κ°€μΉκ΄€κ³Ό μ„ νΈμ— λ§κ² λ‹µλ³€ν•λ„λ΅ μ΅°μ •. (DPO, GRPO λ“± μ μ©)
3.  **CPT (Continuous Pre-training)**: νΉμ • λ„λ©”μΈ(λ²•λ¥ , μλ£ λ“±)μ μ›μ‹ λ°μ΄ν„°λ¥Ό λ€λ‰μΌλ΅ μ¶”κ°€ ν•™μµμ‹ν‚¤λ” κ³Όμ •.

### π« νλ©Έμ  λ§κ° (Catastrophic Forgetting)
- μƒλ΅μ΄ μ§€μ‹μ„ λ°°μ°λ©° μ›λμ λ€μ¤‘μ μΈ μ§€μ‹μ„ μƒμ–΄λ²„λ¦¬λ” ν„μƒμ…λ‹λ‹¤.
- **λ°©μ§€ μ „λµ**: LoRAμ™€ κ°™μ€ PEFT κΈ°λ²• μ‚¬μ©, ν•™μµ μ‹ μΌλ° μƒμ‹ λ°μ΄ν„°λ¥Ό μΌλ¶€ μ„μ–΄μ£Όλ” Replay κΈ°λ²• ν™μ©.

---

## 2. ν¨μ¨μ  λ§¤κ°λ³€μ ν•™μµ (PEFT)
μ „μ²΄ νλΌλ―Έν„°λ¥Ό μμ •ν•λ” λ€μ‹  κ³ λ„μ μλ¦¬μ  κΈ°λ²•μ„ ν†µν•΄ 1% λ―Έλ§μ νλΌλ―Έν„°λ§ ν•™μµν•μ—¬ λΉ„μ©μ„ νκΈ°μ μΌλ΅ λ‚®μ¶¥λ‹λ‹¤.

### π“‰ LoRA (Low-Rank Adaptation)μ μλ¦¬ λ¨λΈ
- **μ›λ¦¬**: κΈ°μ΅΄ κ°€μ¤‘μΉ($W_0$)λ” μ–Όλ¦¬κ³ , μ†μ— λ¶™μΈ μ €μ°¨μ› ν–‰λ ¬($A, B$)μ κ³±($AB$)λ§ ν•™μµν•©λ‹λ‹¤. $W = W_0 + AB$.
- **νλΌλ―Έν„°**: 
    - **Rank ($r$)**: ν–‰λ ¬ $A, B$μ ν¬κΈ°. λ†’μ„μλ΅ ν’λ¶€ν• ν•™μµμ΄ κ°€λ¥ν•μ§€λ§ λ©”λ¨λ¦¬ μ”κµ¬λ‰μ΄ λμ–΄λ‚©λ‹λ‹¤.
    - **Alpha ($\alpha$)**: ν•™μµ κ²°κ³Όλ¥Ό λ¨λΈμ— λ°μν•  λ•μ κ°€μ¤‘μΉ κ³„μμ…λ‹λ‹¤.

### π€ μ°¨μ„Έλ€ PEFT κΈ°μ 
- **DoRA (Weight-Decomposed LoRA)**: κ°€μ¤‘μΉλ¥Ό **Magnitude(ν¬κΈ°)**μ™€ **Direction(λ°©ν–¥)**μΌλ΅ λ¶„ν•΄ν•μ—¬ ν•™μµν•¨μΌλ΅μ¨ Full FTμ™€ μ μ‚¬ν• μ„±λ¥μ„ λ‹¬μ„±ν•©λ‹λ‹¤.
- **GaLore**: κΈ°μΈκΈ°(Gradient) μμ²΄λ¥Ό μ €μ°¨μ›μΌλ΅ ν¬μν•μ—¬ λ€ν• λ¨λΈ ν•™μµ μ‹ VRAMμ„ κ·Ήλ‹¨μ μΌλ΅ μ μ•½ν•©λ‹λ‹¤.

---

## 3. ν•λ“μ›¨μ–΄ κ°€μ†κ³Ό μ–‘μν™” (Quantization)
### π’ QLoRAμ™€ NF4
- **NF4 (NormalFloat 4)**: λ¨λΈ κ°€μ¤‘μΉκ°€ μ •κ· λ¶„ν¬λ¥Ό λ”°λ¥Έλ‹¤λ” νΉμ„±μ„ μ΄μ©ν• 4λΉ„νΈ μ–‘μν™” ν•μ‹μΌλ΅, μ •λ³΄ μ†μ‹¤μ„ μµμ†ν™”ν•λ©° λ©”λ¨λ¦¬λ¥Ό 4λ°° μ΄μƒ μ••μ¶•ν•©λ‹λ‹¤.
- **Paged Optimizer**: λ©”λ¨λ¦¬ λ¶€μ΅± μ‹ CPU RAMμ„ ν™μ©ν•μ—¬ OOM(Out of Memory) μ‚¬κ³ λ¥Ό λ°©μ§€ν•©λ‹λ‹¤.

---

## 4. μ •λ ¬κ³Ό μµμ‹  κ°•ν™”ν•™μµ μ•κ³ λ¦¬μ¦
### β–οΈ μµμ‹  μ •λ ¬ κΈ°μ  λΉ„κµ
- **DPO (Direct Preference Optimization)**: λ³„λ„μ λ³΄μƒ λ¨λΈ μ—†μ΄ μν•™μ μΌλ΅ μ„ νΈ λ°μ΄ν„°λ¥Ό μ§μ ‘ μµμ ν™”ν•μ—¬ μ•μ •μ„±κ³Ό ν¨μ¨μ„ ν™•λ³΄ν•©λ‹λ‹¤.
- **GRPO (Group Relative Policy Optimization)**: λ‹µλ³€ λ¬¶μ λ‚΄μ μƒλ€μ  λ“±μλ¥Ό λ§¤κ²¨ λ³΄μƒν•λ” λ°©μ‹μ…λ‹λ‹¤. λ³΄μƒ λ¨λΈμ΄ μ—†λ” ν™κ²½μ—μ„λ„ λ¨λΈμ μ¶”λ΅  μ§€λ¥μ„ ν­λ°μ μΌλ΅ λ†’μ΄λ” ν•µμ‹¬ κΈ°μ (DeepSeek R1 λ“±)μ…λ‹λ‹¤.
- **ORPO**: SFTμ™€ μ •λ ¬μ„ ν•λ‚μ κ³Όμ •μΌλ΅ μν–‰ν•μ—¬ λ‹¨κ³„ κ°„ μ •λ³΄ μ μ‹¤μ„ λ§‰κ³  μμ›μ„ μ•„λ‚λ‹λ‹¤.

---

## 5. μµμ‹  ν•™μµ λ„κµ¬μ™€ μ„±κ³Ό μ§€ν‘
- **Unsloth**: LoRA ν•™μµ κ³Όμ •μ„ μλ¦¬μ μΌλ΅ μµμ ν™”ν•μ—¬ μ†λ„λ” 2λ°° μ΄μƒ λ†’μ΄κ³  VRAM μ μ λ” μ λ°μΌλ΅ μ¤„μ—¬μ¤λ‹λ‹¤.
- **Perplexity (PPL)**: μμΉκ°€ λ‚®μ„μλ΅ μ–Έμ–΄ λ¨λΈμ΄ λ‹¤μμ— μ¬ λ‹¨μ–΄λ¥Ό λ” ν™•μ‹  μκ² μμΈ΅ν•κ³  μμμ„ μλ―Έν•©λ‹λ‹¤.
- **MergeKit**: μ„λ΅ λ‹¤λ¥΄κ² νλ‹λ λ‘ λ¨λΈμ„ μμΉμ μΌλ΅ κ²°ν•©(Merging)ν•μ—¬ μ¥μ λ§μ„ κ°€μ§„ μƒ λ¨λΈμ„ μƒμ„±ν•λ” λ„κµ¬μ…λ‹λ‹¤.

μ΄μƒμ μ „λ¬Έ μ§€μ‹μ„ μ™„λ²½ν μ™μ§€ν•λ©΄ νμΈνλ‹ λ‹¨μ›μ 720κ° λ¬Έν•­ μ¤‘ μ–΄λ–¤ λ¬Έμ λΌλ„ λ…Όλ¦¬μ μΌλ΅ ν•΄κ²°ν•  μ μμµλ‹λ‹¤.